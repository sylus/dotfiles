{{ if (eq .chezmoi.os "linux") -}}
#!/bin/bash

set -eufo pipefail

{{ if (eq .chezmoi.osRelease.id "debian" "ubuntu") -}}
repositories=()
packages=(
        curl
        vim
)
snaps=()
classic_snaps=()

{{ if (not .transient) }}
{{ if (and (eq .chezmoi.osRelease.id "ubuntu") (eq .chezmoi.osRelease.versionCodename "groovy")) }}
classic_snaps+=(
        go
)
{{ end }}
packages+=(
        direnv
        git-lfs
        jq
        vim-gtk
        zsh
)
classic_snaps+=(
        code
)
{{ end }}

for repository in ${repositories[@]}; do
        sudo add-apt-repository -y $repository
done

sudo apt update
sudo apt install -y ${packages[@]}

{{ if (eq .chezmoi.osRelease.id "ubuntu") }}
for snap in ${snaps[@]}; do
        sudo snap install $snap
done

for classic_snap in ${classic_snaps[@]}; do
        sudo snap install $classic_snap --classic
done
{{ end }}

{{ end -}}
{{ end -}}
